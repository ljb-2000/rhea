.row
  .col-md-7
    .pull-right
      = form_tag commands_path, method: 'GET', class: 'form-inline' do
        .form-group
          = label_tag :image, 'Image:', style: 'margin-right: 5px; font-size: 12px; font-weight: normal;'
          = select_tag :image, options_for_select([['All', nil]] + @images, params[:image].presence), class: 'form-control input-sm', onchange: "$(this).closest('form').submit();"
    %h3 Commands
    %br
    - if @commands.blank?
      %p No commands found.
    - else
      = form_tag update_all_commands_path, method: 'POST' do
        = hidden_field_tag :redirect_to, request.fullpath
        %table.table.table-striped
          %thead
            %tr
              %th Image
              %th Command
              %th Processes
              %th Desired Processes
              %th
          %tbody
            - @commands.each do |command|
              %tr
                %td= command.image
                %td= command.expression
                %td= command.process_count
                %td
                  = text_field_tag "commands_process_counts[#{command.expression}]", nil, class: 'form-control', style: 'width: 50px;'
                %td
                  - if command.process_count == 0
                    = link_to 'Delete', delete_commands_path(command: CGI.escape(command.expression)), class: 'btn btn-danger', style: 'margin-left: 10px;'
            %tr
              %td
              %td
              %td
              %td= submit_tag 'Save', class: 'btn btn-default'
              %td

  .col-md-5
    .panel.panel-default
      .panel-heading
        %h4 New Command
      .panel-body
        = form_tag commands_path, method: 'POST' do
          = hidden_field_tag :redirect_to, request.fullpath
          %table.table
            %thead
              %tr
                %th Type
                %th Input
                %th Processes
            %tbody
              %tr
                %td= select_tag :command_type_key, options_for_select(Rhea::CommandType.options_for_select, Rhea.settings[:default_command_type_key]), class: 'form-control', style: 'width: 90px;', required: 'required'
                %td= text_field_tag :command_type_input, nil, class: 'form-control', style: 'width: 230px;', required: 'required'
                %td= text_field_tag :process_count, nil, class: 'form-control', style: 'width: 50px;', required: 'required'
          = submit_tag 'Create', class: 'btn btn-default'

    .panel.panel-default
      .panel-heading
        %h4 Command Types
      .panel-body
        = render partial: 'rhea/command_types/list'
